package main;


import main.ciphers.*;
import main.breakers.*;
import main.utils.periodanalysers.*;
import main.utils.*;

import java.util.Arrays;

import static main.utils.TextUtilities.*;

public class Main {
    public static void main(String[] args) {
        Constants.initialize();

        String cipherText = """
                PWNYPCGUUMYYUIAGGUGFEMWLRNYAHOGGHBAEWCXWPAQSXPAGNITNIX
                WBQFKMLVIFHDTLSMADKMWWXXNYCQYBVWIKHWYARVTKXXAVGBGLVITN
                WVNMKMUWRYQWRNEHYBCHUTNYQKYHIXWFWTQSLVYKRKZUHXZKVMQPHC
                YALCRWHDKGJGTNOKSHXPAPHAGWQVGUHCXYUIAMXPKLXQRWKWNBXVTM
                EMGGIXWYOMADHKGFWQQYQKYAHMHXRBYLRNYAHWRYXMZKFBEIXXIKWY
                JWUCCARGTKNMNMLBGEHCXECDTVHLKIKMWQKWYSREOYOTYAHWWMLNAU
                XVGPHBYAHTGLVTGMYCYYNMYALCTISXWMYVKMCVTQXXMKLVIHYBYQRY
                GHSTGLXXIWXPGKWTQHAUGIOMALHDTXLBXMWYTEROKTHDJWWBYBIWOM
                AWXIOWOWGXSMKMQNQWWLYBHYFMHYUDTHVXTGWCCWKWNYQDKULYAMHK
                YAWDEHYGTNOKAUKQGPHCUYFMYKWFGEPEOAHWWELMWMKQXLKXZEGMDI
                OWKGXPGYSYAKHVYYJMTXXPGYUDKXWLYYQKYAHLWNGMSWVCTXXPGEWV
                INWOGQUQYMHVZIRVKMLDJYVCZXIMWWGDJWLUUYFDTXFXZGXTGLVUKU
                UXRWXMTKVDJYXQRIWLYMKMQNQWWLYBHYFMOHQDKGYWQECNZKXPGKPX
                WWXPGFHCXYJMCKLDYWQXSBXGALFXRIRCGVEIRSSBGVHLGLVXWLAPTQ
                HBGEWBIWOIKZQXWYQDTXCXZKOWSZYWIWLUZLXWQLRWUHOXIBDMHHUD
                JWGMQYCQSHYBKGXBTVYLYBRVXBQLGBXCUEWLGFHVYQKQQWWDYAWDYB
                PMCWKWNIOWSGHKYHLVKMLWYWFXSMWLYBPUGVLWYWOIZIRVEHYBHBUC
                YPLCKMXXEHYBUEWVGMVCAMHTQBXMKMKWNLLVOWXPAMXQRWEMGGGMOB
                GMNMKWYQHCJHYTNGRDWWZMAEREWLHTBWVESMLTEHYBXHFQGMCPAVUM
                AUKMNSHDAZUMAMHBQWZMQHIDGUKVTEROKUWTXHSPKLXQOYXQTGKXCW
                ZMWSREWVLCOHZMWSRNYAHWWMLNAUXWSVGMOBSPGKPMSMRNKMKWXIUM
                OBSQYYXMNMKQXBQDWHGEOMLXSBQDJWXQRWVQSUHDJWWBYBIWOMVLWW
                WDKHQWSVSTAUHUGGXXSMKMQNQWWLYBHYFMCWKWBWEMGGAXWDLVIMRP
                GESITNWLJBHFGMKWYMHLJGRTTZLLAEVXUALCYBFWYBRVTXAPKUKQXI
                HWPBQBGUHVYVHLAVHCEHYBXHFQGMCPALHHUWUQGGFMNYQMDIRVGGXQ
                AEJBTQXPKGXPGYUMALRNMBRLJWPQXMUIRWGQOBQMGGJQSWHBKGJYJS
                VQOLWVNURUUNXWYBRVNNHQSEWBIWSWWMXXYAHQSCHLYBRVTXLKGYVW
                SVXMOAQQVNHCKGXXEHYBXULMSMLNKUOQYWUWYNUMMSREWFHUMWUCYA
                HCGYUMJHAMBWUUGKHTEMKMMWJQSGLVIHIGJYXGGUWVNHIXWSREWLRL
                KWXIYHAQYQHPAPHWQLRAGWQWQOHQYLOXCECDTAHTUSRECBXPYAHQRI
                UXBWPMSMRNTMKMWXWLGMVXHSREWLRLKWXIKMLCSHWLOBGMSMXPAMWK
                BYQLGLLVYWFPSHOXISWBGYFLTFSWSBHKMSWKBYQLGLLVXNUFGBOTAG
                FMKMLCCBXPXNFPAVZWSUHCYAWDCWKXUWXXJWOYEHYDTJYMQEXPGUKW
                TLWVNNQYWWGQOMWAKELDEMKWYIOWINHCEHYBWYFMXMWAKELDEYQKOH
                QDWHOWWWHCXWQDKYONTKYCJWUQSZEXYAREWIHXUEHCKGXXAGHGAZHX
                HURXUWUWYBRVAGGYWHVYGKLDEYVQYLWIXHQDJWWBYBIWOMWVNYVGGQ
                LTQYOGASVCASXXEHYGGURUGBQYGYFMCWRNHWUUAGCOKXXCYHCXZBQB
                GMYBSQHXSECWXDCXZKRAGVLMSUH
                """;
        String plainText = """
                """;
        String key = "CSKTFVRMGQLEXDHPJIZANBOUWY";
        String[] periodicKeys = new String[]{"LBRUVCJAWZYSHXINOQEPFTGKDM","SLNAXDIGOBKCEYQHTMWJFUVPZR","IFWVBXNGKHZQYOELPCDTJRUSAM"};

        byte[] cipherTextBytes = formatAndConvertToBytes(cipherText);
        byte[] plainTextBytes = formatAndConvertToBytes(plainText);
        byte[] keyBytes = formatAndConvertToBytes(key);
        byte[][] keysBytes = convertToByteArrays(periodicKeys, Constants.alphabet);
        byte[][] cribsBytes = convertToByteArrays(new String[]{"VICTORY", "SPAIN", "DISCO", "EUROVISION"},Constants.alphabet);


        long startTime = System.currentTimeMillis();


        //System.out.println(Arrays.toString(KasiskiExamination.examine(cipherTextBytes)));
        //System.out.println(Arrays.toString(IOCPeriodAnalyser.guessPeriod(cipherTextBytes, 16)));
        //System.out.println(Arrays.deepToString(TwistMethodPeriodAnalyser.guessPeriod(cipherTextBytes, 5, 16)));

        //printBytes(Quagmire4Cipher.decipher(cipherTextBytes, TextUtilities.formatAndConvertToBytes("FOUR"), TextUtilities.formatAndConvertToBytes("PIGMENT"), TextUtilities.formatAndConvertToBytes("COLOR")));

        CipherBreakerOutput<byte[][]> cbo = PeriodicPolyAlphabeticSubstitutionBreaker.hillClimber(cipherTextBytes, 4, 1000000);
        cbo.displayPlaintext();
        printBytes(cbo.key.get(0));


        long endTime = System.currentTimeMillis();
        System.out.println("Execution time: " + (endTime - startTime) + "ms");
    }
}
