package main;

import main.breakers.VigenereCipherBreaker;
import main.utils.*;

public class Main {
    public static void main(String[] args) {
        Constants.initialize(false, false);

        String cipherText = """
                ARVYIMZVGVQHFXJJWBFGGVHPSVFJRHOHGEFXYEPYMLOLKJXEWFNFAB
                FKERQISMIEEZSMPJXMZIPRXBGRCCWXUYTZXRSKGEGRLLGWSKEITXSO
                WVPDIGLGQEXKSGVFVASWGOTHKIFKLXSKGEGRKQCJWBNIQEPBFIGRZX
                KHTFTIARIVJYGVVJEGVEVKIFHXUKSVAVELQOWRVVRVJCRKMHFYUVHM
                GWGTYKWHKXMMSPEFQFMRKTEMASPJXAWPCKILLENCIZSXKFRLARFZGT
                LIVYIGKEORRBHYNRXXVEPUAXSOGEIWSGTPTMGKTRTAQWVRRWSVFKLX
                FEVZSGSPKEWMAXWKIHXWVRRWSVFJEGVXGTLGGPQXCASHKJWNWHUVZX
                JENPITJWCXSTKETVWNDXPZWMDEUKAXWORLFEAGNPHBKGQLVTYIFKIV
                ZGQDTTFMGJJKGQWJMGYXJRXVJCRKSZJERYMVSTRISTULCEHIJSOZWX
                VXQXMOWXJVTNTPKTEGGTRFVMMRKKCMGAGZKAARQEEKWZKJIWKXCEHT
                JHVYIYABORCGGXDVEEDXJRXWAJHZGNDXVYIMSMPKIWHETKSYLLGJXT
                FHCIHBKEJZKADCKEIYXMEZIGLENXSKAXJDXASXUVGNJMVPIQHITKWB
                VIPKMYAIFRWTHVQSPXEPQEKTYSKEJTUXVYIUAKIVWMECUKIKQXJFWX
                WBRVVMKWCPMLOLAKLXFWCKLHMKJKEGQGQDTTFCQIKHNITEQXFXCXIG
                UCYFYEVAKCPBFKNPYLWXJRXISVVZGNDETRPZGVKKLFLSRISMWGVKLX
                AVFRXT
                """;
        String plainText = """
                ADALOVELACEANDCHARLESBABBAGEARETWOOFTHEMOSTIMPORTANTMEMBERSOFOURCOMMUNITYTHEYFEATUREDINTHEFIRSTNATIONALCIPHERCHALLENGEANDAGAINSOMEYEARSLATERWHENWEEXPLOREDTHEIREARLYMEETINGINTHISADVENTUREWEARERETURNINGTOTHEENDOFHERLIFEATLEASTTHEPARTRECORDEDINTHEARCHIVESATBOSSHEADQUARTERSIFOUNDTHISSTORYBYACCIDENTWHENIWASRESEARCHINGTHEROLEOFTHEROYALFAMILYINOURNATIONALSECURITYMANYOFTHEMSERVEDINTHEMILITARYANDAREFAMILIARWITHCODESANDCIPHERSANDIWONDEREDHOWFARBACKTHATINTERESTWENTTHATWASHOWISTUMBLEDACROSSANOTEFROMPRINCEALBERTTOLORDPALMERSTONANDTHATSTARTEDMEDOWNTHERABBITHOLETHATLEDUSHEREIHOPEYOUENJOYITASMUCHASIDIDWEWILLMEETSOMEFASCINATINGNEWCHARACTERSONTHEWAYANDTHESTORYTAKESATWISTORTWOOFCOURSEIKNOWHOWITENDSYOUDONTYETBUTIFYOUSTICKWITHITYOUWILLANDLIKEMEYOUWILLPROBABLYLEARNSOMETHINGONTHEWAYIHAVEPOSTEDASKETCHOFABULLETTHATWASSENTTOADABACKINONTHECASEFILESPAGETHATWASWHERETHESTORYBEGANANDWHATDREWADAINTAKEALOOKANDSEEIFYOUCANFIGUREOUTWHATITMIGHTHAVEMEANTITISNOTABADPLACETOSTART
                """;
        cipherText = TextFormatter.formatText(cipherText);
        plainText = TextFormatter.formatText(plainText);


        long startTime = System.currentTimeMillis();

        VigenereCipherBreaker.bruteforceWithWordlist(cipherText).displayPlaintext();

        long endTime = System.currentTimeMillis();
        System.out.println("Execution time: " + (endTime - startTime) + "ms");
    }
}
